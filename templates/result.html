<!DOCTYPE html>
<html>
<head>
    <title>Clinical Dashboard - MedIntelix AI</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        body {
            margin: 0;
            font-family: 'Segoe UI', sans-serif;
            background: #0f172a;
            color: white;
        }

        .main {
            padding: 40px;
            max-width: 900px;
            margin: auto;
        }

        .card-ui {
            background: #1e293b;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 20px;
        }

        .param-card {
            background: #111827;
            padding: 12px 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .badge-severe { background:#ef4444; }
        .badge-moderate { background:#f59e0b; }
        .badge-mild { background:#eab308; color:black; }
        .badge-normal { background:#10b981; }

        .badge {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 12px;
        }

        .chart-container {
            width: 180px;
            height: 180px;
            position: relative;
            margin: auto;
        }

        .chart-center-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 22px;
            font-weight: 600;
        }

        h2,h4 {
            font-weight: 600;
        }
    </style>
</head>
<body>

<div class="main">

    <h2 class="mb-4 text-center">ðŸ§  Clinical Intelligence Dashboard</h2>

    <!-- Risk Score -->
    <div class="card-ui text-center">
        <h4>Health Risk Score</h4>

        <div class="chart-container">
            <canvas id="riskChart"></canvas>
            <div class="chart-center-text">
                {{ risk_score }}%
            </div>
        </div>
    </div>

    <!-- Parameters -->
    <div class="card-ui">
        <h4 class="mb-3">Analyzed Parameters</h4>

        {% for item in results %}
        <div class="param-card">
            <div>
                <strong>{{ item.name }}</strong>
                <div style="opacity:0.7;font-size:13px;">
                    Value: {{ item.value }}
                </div>
            </div>

            <span class="badge
                {% if 'Severe' in item.status %}badge-severe
                {% elif 'Moderate' in item.status %}badge-moderate
                {% elif 'Mild' in item.status %}badge-mild
                {% else %}badge-normal
                {% endif %}
            ">
                {{ item.status }}
            </span>
        </div>
        {% endfor %}
    </div>

    <!-- Summary -->
    <div class="card-ui">
        <h4>AI Clinical Summary</h4>
        <p class="mt-3">{{ summary }}</p>
    </div>

    <div class="text-center mt-4">
        <a href="/" class="btn btn-info">â¬… Analyze Another Report</a>
    </div>

</div>

<script>
const ctx = document.getElementById('riskChart');

new Chart(ctx, {
    type: 'doughnut',
    data: {
        datasets: [{
            data: [{{ risk_score }}, 100 - {{ risk_score }}],
            backgroundColor: ['#ef4444', '#10b981'],
            borderWidth: 0
        }]
    },
    options: {
        responsive: true,
        maintainAspectRatio: false,
        cutout: '80%',
        plugins: {
            legend: { display: false }
        }
    }
});
</script>

</body>
</html>